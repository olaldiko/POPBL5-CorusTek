\hypertarget{mcast_messaging_8h}{}\section{ras\+Pi-\/\+Emergency\+Station/mcast\+Messaging.h File Reference}
\label{mcast_messaging_8h}\index{ras\+Pi-\/\+Emergency\+Station/mcast\+Messaging.\+h@{ras\+Pi-\/\+Emergency\+Station/mcast\+Messaging.\+h}}


F\+Ile containing all the headers of the functions related to multicast communication.  


{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$sys/types.\+h$>$}\\*
{\ttfamily \#include $<$sys/socket.\+h$>$}\\*
{\ttfamily \#include $<$netinet/in.\+h$>$}\\*
{\ttfamily \#include $<$arpa/inet.\+h$>$}\\*
{\ttfamily \#include \char`\"{}structures.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}msg\+Buffers.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{mcast_messaging_8h_a32f623ef7b7dc548989d4bb8aff3e035}{M\+C\+M\+\_\+\+G\+E\+N\+\_\+\+P\+O\+RT}~7000
\begin{DoxyCompactList}\small\item\em Port to listen to the general group. \end{DoxyCompactList}\item 
\#define \hyperlink{mcast_messaging_8h_a0aca9247ae9f72e25004d2160e5171b5}{M\+C\+M\+\_\+\+S\+T\+A\+T\+I\+O\+N\+\_\+\+P\+O\+RT}~8000
\begin{DoxyCompactList}\small\item\em Port to send the messages to the station group. \end{DoxyCompactList}\item 
\#define \hyperlink{mcast_messaging_8h_ad94bd4dda155400b7be19125ffbad803}{M\+C\+M\+\_\+\+G\+E\+N\+E\+R\+A\+L\+\_\+\+G\+RP}~\char`\"{}239.\+128.\+0.\+1\char`\"{}
\begin{DoxyCompactList}\small\item\em Address of the general group. \end{DoxyCompactList}\item 
\#define \hyperlink{mcast_messaging_8h_ab33288a7b770e357bc20b1f9e2e32de2}{M\+C\+M\+\_\+\+B\+U\+F\+F\+S\+I\+ZE}~1024
\begin{DoxyCompactList}\small\item\em Buffer size for the incoming messages. \end{DoxyCompactList}\item 
\#define \hyperlink{mcast_messaging_8h_abde2f0f8d51b43b08c3db243ddb3f5d6}{M\+C\+M\+\_\+\+M\+A\+X\+M\+S\+G\+S\+I\+ZE}~1020
\begin{DoxyCompactList}\small\item\em Maximum message size for the incoming messages. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{mcast_messaging_8h_a4fd8b31a6cdd8fa515f1b3680a754def}{M\+C\+M\+\_\+init\+Mcast\+Server} ()
\begin{DoxyCompactList}\small\item\em Intialize the multicast U\+DP listener and sender. \end{DoxyCompactList}\item 
void \hyperlink{mcast_messaging_8h_a197c2b5442d03afeb798d31b9ffaa3d7}{M\+C\+M\+\_\+shutdown\+Mcast\+Server} ()
\begin{DoxyCompactList}\small\item\em Close the sockets and stop all threads of multicast comunication. \end{DoxyCompactList}\item 
void \hyperlink{mcast_messaging_8h_ad5775544efb4010edd675f4fabbacdfb}{M\+C\+M\+\_\+init\+Sockets} ()
\begin{DoxyCompactList}\small\item\em Initialize the sockets for multicast communication. \end{DoxyCompactList}\item 
struct in\+\_\+addr \hyperlink{mcast_messaging_8h_ab72d654feaaf6ca97ec5c605445154bb}{M\+C\+M\+\_\+calc\+Station\+Address} ()
\begin{DoxyCompactList}\small\item\em Caltulate address for the multicast group. \end{DoxyCompactList}\item 
void \hyperlink{mcast_messaging_8h_a672a537fdc193c0ce1d7175b9f26e3cf}{M\+C\+M\+\_\+init\+Station\+Group} ()
\begin{DoxyCompactList}\small\item\em Sets the station group to the one that we have calculated first. \end{DoxyCompactList}\item 
void \hyperlink{mcast_messaging_8h_ac5fae8e7dd4561321e0311a2bd76ac63}{M\+C\+M\+\_\+init\+General\+Group} ()
\begin{DoxyCompactList}\small\item\em Initialize the general groups. \end{DoxyCompactList}\item 
void $\ast$ \hyperlink{mcast_messaging_8h_ab9bc9b5c01c8c3a09c75e662eb019f04}{M\+C\+M\+\_\+listener\+Thread} (void $\ast$args)
\begin{DoxyCompactList}\small\item\em Thread for listening to messages coming from the general multicast group. \end{DoxyCompactList}\item 
void $\ast$ \hyperlink{mcast_messaging_8h_a82322ed09bb5d8af36d46860d2f49e2d}{M\+C\+M\+\_\+sender\+Thread} (void $\ast$args)
\begin{DoxyCompactList}\small\item\em Thread for sending the messages to the station multicast group. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{struct_m_c_m__server_stats}{M\+C\+M\+\_\+server\+Stats} \hyperlink{mcast_messaging_8h_a6d26c0a446e128139e6f54cf41a552b6}{mcm\+Server\+Stats}
\begin{DoxyCompactList}\small\item\em Variable to store all the multicast server info. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
F\+Ile containing all the headers of the functions related to multicast communication. 



\subsection{Macro Definition Documentation}
\index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+\+B\+U\+F\+F\+S\+I\+ZE@{M\+C\+M\+\_\+\+B\+U\+F\+F\+S\+I\+ZE}}
\index{M\+C\+M\+\_\+\+B\+U\+F\+F\+S\+I\+ZE@{M\+C\+M\+\_\+\+B\+U\+F\+F\+S\+I\+ZE}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+\+B\+U\+F\+F\+S\+I\+ZE}{MCM_BUFFSIZE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+C\+M\+\_\+\+B\+U\+F\+F\+S\+I\+ZE~1024}\hypertarget{mcast_messaging_8h_ab33288a7b770e357bc20b1f9e2e32de2}{}\label{mcast_messaging_8h_ab33288a7b770e357bc20b1f9e2e32de2}


Buffer size for the incoming messages. 

\index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+\+G\+E\+N\+\_\+\+P\+O\+RT@{M\+C\+M\+\_\+\+G\+E\+N\+\_\+\+P\+O\+RT}}
\index{M\+C\+M\+\_\+\+G\+E\+N\+\_\+\+P\+O\+RT@{M\+C\+M\+\_\+\+G\+E\+N\+\_\+\+P\+O\+RT}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+\+G\+E\+N\+\_\+\+P\+O\+RT}{MCM_GEN_PORT}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+C\+M\+\_\+\+G\+E\+N\+\_\+\+P\+O\+RT~7000}\hypertarget{mcast_messaging_8h_a32f623ef7b7dc548989d4bb8aff3e035}{}\label{mcast_messaging_8h_a32f623ef7b7dc548989d4bb8aff3e035}


Port to listen to the general group. 

\index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+\+G\+E\+N\+E\+R\+A\+L\+\_\+\+G\+RP@{M\+C\+M\+\_\+\+G\+E\+N\+E\+R\+A\+L\+\_\+\+G\+RP}}
\index{M\+C\+M\+\_\+\+G\+E\+N\+E\+R\+A\+L\+\_\+\+G\+RP@{M\+C\+M\+\_\+\+G\+E\+N\+E\+R\+A\+L\+\_\+\+G\+RP}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+\+G\+E\+N\+E\+R\+A\+L\+\_\+\+G\+RP}{MCM_GENERAL_GRP}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+C\+M\+\_\+\+G\+E\+N\+E\+R\+A\+L\+\_\+\+G\+RP~\char`\"{}239.\+128.\+0.\+1\char`\"{}}\hypertarget{mcast_messaging_8h_ad94bd4dda155400b7be19125ffbad803}{}\label{mcast_messaging_8h_ad94bd4dda155400b7be19125ffbad803}


Address of the general group. 

\index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+\+M\+A\+X\+M\+S\+G\+S\+I\+ZE@{M\+C\+M\+\_\+\+M\+A\+X\+M\+S\+G\+S\+I\+ZE}}
\index{M\+C\+M\+\_\+\+M\+A\+X\+M\+S\+G\+S\+I\+ZE@{M\+C\+M\+\_\+\+M\+A\+X\+M\+S\+G\+S\+I\+ZE}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+\+M\+A\+X\+M\+S\+G\+S\+I\+ZE}{MCM_MAXMSGSIZE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+C\+M\+\_\+\+M\+A\+X\+M\+S\+G\+S\+I\+ZE~1020}\hypertarget{mcast_messaging_8h_abde2f0f8d51b43b08c3db243ddb3f5d6}{}\label{mcast_messaging_8h_abde2f0f8d51b43b08c3db243ddb3f5d6}


Maximum message size for the incoming messages. 

(Each pass) \index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+\+S\+T\+A\+T\+I\+O\+N\+\_\+\+P\+O\+RT@{M\+C\+M\+\_\+\+S\+T\+A\+T\+I\+O\+N\+\_\+\+P\+O\+RT}}
\index{M\+C\+M\+\_\+\+S\+T\+A\+T\+I\+O\+N\+\_\+\+P\+O\+RT@{M\+C\+M\+\_\+\+S\+T\+A\+T\+I\+O\+N\+\_\+\+P\+O\+RT}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+\+S\+T\+A\+T\+I\+O\+N\+\_\+\+P\+O\+RT}{MCM_STATION_PORT}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+C\+M\+\_\+\+S\+T\+A\+T\+I\+O\+N\+\_\+\+P\+O\+RT~8000}\hypertarget{mcast_messaging_8h_a0aca9247ae9f72e25004d2160e5171b5}{}\label{mcast_messaging_8h_a0aca9247ae9f72e25004d2160e5171b5}


Port to send the messages to the station group. 



\subsection{Function Documentation}
\index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+calc\+Station\+Address@{M\+C\+M\+\_\+calc\+Station\+Address}}
\index{M\+C\+M\+\_\+calc\+Station\+Address@{M\+C\+M\+\_\+calc\+Station\+Address}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+calc\+Station\+Address()}{MCM_calcStationAddress()}}]{\setlength{\rightskip}{0pt plus 5cm}struct in\+\_\+addr M\+C\+M\+\_\+calc\+Station\+Address (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{mcast_messaging_8h_ab72d654feaaf6ca97ec5c605445154bb}{}\label{mcast_messaging_8h_ab72d654feaaf6ca97ec5c605445154bb}


Caltulate address for the multicast group. 

Calculates the group address based on the ID of the station. The address is changed to little endian first to add the id value. Then is converted back. \begin{DoxyReturn}{Returns}
The in\+\_\+addr structure with the address. 
\end{DoxyReturn}
\index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+init\+General\+Group@{M\+C\+M\+\_\+init\+General\+Group}}
\index{M\+C\+M\+\_\+init\+General\+Group@{M\+C\+M\+\_\+init\+General\+Group}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+init\+General\+Group()}{MCM_initGeneralGroup()}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+C\+M\+\_\+init\+General\+Group (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{mcast_messaging_8h_ac5fae8e7dd4561321e0311a2bd76ac63}{}\label{mcast_messaging_8h_ac5fae8e7dd4561321e0311a2bd76ac63}


Initialize the general groups. 

Sets the kernel to join the general multicast group. \index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+init\+Mcast\+Server@{M\+C\+M\+\_\+init\+Mcast\+Server}}
\index{M\+C\+M\+\_\+init\+Mcast\+Server@{M\+C\+M\+\_\+init\+Mcast\+Server}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+init\+Mcast\+Server()}{MCM_initMcastServer()}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+C\+M\+\_\+init\+Mcast\+Server (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{mcast_messaging_8h_a4fd8b31a6cdd8fa515f1b3680a754def}{}\label{mcast_messaging_8h_a4fd8b31a6cdd8fa515f1b3680a754def}


Intialize the multicast U\+DP listener and sender. 

Initializes all the sockets, threads and structures needed for the multicast communications. \index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+init\+Sockets@{M\+C\+M\+\_\+init\+Sockets}}
\index{M\+C\+M\+\_\+init\+Sockets@{M\+C\+M\+\_\+init\+Sockets}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+init\+Sockets()}{MCM_initSockets()}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+C\+M\+\_\+init\+Sockets (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{mcast_messaging_8h_ad5775544efb4010edd675f4fabbacdfb}{}\label{mcast_messaging_8h_ad5775544efb4010edd675f4fabbacdfb}


Initialize the sockets for multicast communication. 

Initializes both the sockets to listen to the general group and the socket to send the messages to the station group. \index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+init\+Station\+Group@{M\+C\+M\+\_\+init\+Station\+Group}}
\index{M\+C\+M\+\_\+init\+Station\+Group@{M\+C\+M\+\_\+init\+Station\+Group}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+init\+Station\+Group()}{MCM_initStationGroup()}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+C\+M\+\_\+init\+Station\+Group (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{mcast_messaging_8h_a672a537fdc193c0ce1d7175b9f26e3cf}{}\label{mcast_messaging_8h_a672a537fdc193c0ce1d7175b9f26e3cf}


Sets the station group to the one that we have calculated first. 

\begin{DoxySeeAlso}{See also}
\hyperlink{mcast_messaging_8c_ab72d654feaaf6ca97ec5c605445154bb}{M\+C\+M\+\_\+calc\+Station\+Address} 
\end{DoxySeeAlso}
\index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+listener\+Thread@{M\+C\+M\+\_\+listener\+Thread}}
\index{M\+C\+M\+\_\+listener\+Thread@{M\+C\+M\+\_\+listener\+Thread}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+listener\+Thread(void $\ast$args)}{MCM_listenerThread(void *args)}}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ M\+C\+M\+\_\+listener\+Thread (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{args}
\end{DoxyParamCaption}
)}\hypertarget{mcast_messaging_8h_ab9bc9b5c01c8c3a09c75e662eb019f04}{}\label{mcast_messaging_8h_ab9bc9b5c01c8c3a09c75e662eb019f04}


Thread for listening to messages coming from the general multicast group. 

This thread waits for new messages to be received. Then puts the valid messages into the parser\textquotesingle{}s inbox. 
\begin{DoxyParams}{Parameters}
{\em args} & Receives a the socket and the address of the group via structure. \\
\hline
\end{DoxyParams}
\index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+sender\+Thread@{M\+C\+M\+\_\+sender\+Thread}}
\index{M\+C\+M\+\_\+sender\+Thread@{M\+C\+M\+\_\+sender\+Thread}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+sender\+Thread(void $\ast$args)}{MCM_senderThread(void *args)}}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ M\+C\+M\+\_\+sender\+Thread (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{args}
\end{DoxyParamCaption}
)}\hypertarget{mcast_messaging_8h_a82322ed09bb5d8af36d46860d2f49e2d}{}\label{mcast_messaging_8h_a82322ed09bb5d8af36d46860d2f49e2d}


Thread for sending the messages to the station multicast group. 

Waits for messages in the outbox of the station group ands sends those messages. \index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!M\+C\+M\+\_\+shutdown\+Mcast\+Server@{M\+C\+M\+\_\+shutdown\+Mcast\+Server}}
\index{M\+C\+M\+\_\+shutdown\+Mcast\+Server@{M\+C\+M\+\_\+shutdown\+Mcast\+Server}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{M\+C\+M\+\_\+shutdown\+Mcast\+Server()}{MCM_shutdownMcastServer()}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+C\+M\+\_\+shutdown\+Mcast\+Server (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{mcast_messaging_8h_a197c2b5442d03afeb798d31b9ffaa3d7}{}\label{mcast_messaging_8h_a197c2b5442d03afeb798d31b9ffaa3d7}


Close the sockets and stop all threads of multicast comunication. 

Gracefully shutdowns and then closes all the involved sockets. Then, stops the listener and sender thread. 

\subsection{Variable Documentation}
\index{mcast\+Messaging.\+h@{mcast\+Messaging.\+h}!mcm\+Server\+Stats@{mcm\+Server\+Stats}}
\index{mcm\+Server\+Stats@{mcm\+Server\+Stats}!mcast\+Messaging.\+h@{mcast\+Messaging.\+h}}
\subsubsection[{\texorpdfstring{mcm\+Server\+Stats}{mcmServerStats}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+C\+M\+\_\+server\+Stats} mcm\+Server\+Stats}\hypertarget{mcast_messaging_8h_a6d26c0a446e128139e6f54cf41a552b6}{}\label{mcast_messaging_8h_a6d26c0a446e128139e6f54cf41a552b6}


Variable to store all the multicast server info. 

